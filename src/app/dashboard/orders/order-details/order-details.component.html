<div class="order-details-container">
    <h2>Order Details</h2>
    <div class="order-actions" fxLayout="row" fxLayoutAlign="space-between">
        <button type="button" color="primary" mat-raised-button (click)="confirm()">Confirm</button>
        <button type="button" color="primary" mat-raised-button (click)="createFulfillment()">Create Fulfillment</button>
        <button type="button" color="primary" mat-raised-button (click)="fulfill()">Fulfill</button>
        <button type="button" color="primary" mat-raised-button (click)="updateTrackingNumber()">Update Tracking Number</button>
        <button type="button" color="primary" mat-raised-button (click)="cancel()">Cancel</button>
        <button type="button" color="primary" mat-raised-button (click)="reinstate()">Reinstate</button>
        <button type="button" color="primary" mat-raised-button (click)="undoFulfill()">Undo Fulfill</button>
    </div>
    <div>
        <ngx-json-viewer [json]="order"></ngx-json-viewer>
    </div>
    <mat-divider></mat-divider>
    <div class="order-lines-table-container mat-elevation-z8">
        <div>
            <h3 class="table-header">Lines</h3>
        </div>
        <mat-table [dataSource]="lines">

            <ng-container matColumnDef="productName">
                <mat-header-cell *matHeaderCellDef>Product</mat-header-cell>
                <mat-cell *matCellDef="let line">
                    {{ line.productName + (!!line.variantName ? (' , ' + line.variantName) : '') }}
                </mat-cell>
            </ng-container>

            <ng-container matColumnDef="unitPriceAmount">
                <mat-header-cell *matHeaderCellDef>Unit Price</mat-header-cell>
                <mat-cell *matCellDef="let line">
                    {{ line.unitPriceAmount | currencyFormatter: order?.currency }}
                </mat-cell>
            </ng-container>

            <ng-container matColumnDef="quantity">
                <mat-header-cell *matHeaderCellDef>Quantity</mat-header-cell>
                <mat-cell *matCellDef="let line">{{ line.quantity }}</mat-cell>
            </ng-container>

            <ng-container matColumnDef="reservedQuantity">
                <mat-header-cell *matHeaderCellDef>Reserved</mat-header-cell>
                <mat-cell *matCellDef="let line">
                    {{ line.reservedQuantity }}
                </mat-cell>
            </ng-container>

            <ng-container matColumnDef="fulfilledQuantity">
                <mat-header-cell *matHeaderCellDef>Fulfilled</mat-header-cell>
                <mat-cell *matCellDef="let line">
                    {{ line.fulfilledQuantity }}
                </mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="linesDisplayedColumns"></mat-header-row>

            <mat-row *matRowDef="let row; columns: linesDisplayedColumns"></mat-row>

        </mat-table>
        <mat-paginator [length]="lines.length" [pageSize]="10" [pageSizeOptions]="[5, 10, 15, 20]" showFirstLastButtons>
        </mat-paginator>
    </div>
    <div class="order-fulfillments-table-container mat-elevation-z8">
        <h3 class="table-header">Fulfillments</h3>
        <mat-table [dataSource]="fulfillments">

            <ng-container matColumnDef="id">
                <mat-header-cell *matHeaderCellDef>Id</mat-header-cell>
                <mat-cell *matCellDef="let fulfillment">{{ fulfillment.id }}</mat-cell>
            </ng-container>

            <ng-container matColumnDef="completed">
                <mat-header-cell *matHeaderCellDef>Completed</mat-header-cell>
                <mat-cell *matCellDef="let fulfillment">
                    {{ !!fulfillment.completed ? 'Yes' : 'No' }}
                </mat-cell>
            </ng-container>

            <ng-container matColumnDef="fulfillmentDetails">
                <mat-header-cell *matHeaderCellDef></mat-header-cell>
                <mat-cell *matCellDef="let fulfillment">
                    <button type="button" mat-stroked-button
                        (click)="fulfillmentDetails(fulfillment.id)">Details</button>
                </mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="fulfillmentsDisplayedColumns"></mat-header-row>

            <mat-row *matRowDef="let row; columns: fulfillmentsDisplayedColumns"></mat-row>

        </mat-table>
        <mat-paginator [length]="fulfillments.length" [pageSize]="10" [pageSizeOptions]="[5, 10, 15, 20]"
            showFirstLastButtons>
        </mat-paginator>
    </div>
</div>